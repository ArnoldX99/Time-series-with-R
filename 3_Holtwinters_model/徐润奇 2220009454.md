# Homework for Week4

## complains to a motoring organization

```R
#complains to a motoring organization
www <- "D:\\教学资料\\研究生\\时间序列\\data\\chapter3 motororg.dat.txt"
Motor.dat <- read.table(www, header = T)
attach(Motor.dat)
Comp.ts <- ts(complaints, start = 1996, 1, freq = 12)
plot(Comp.ts, xlab = "Time / months", ylab = "Complaints")

Comp.hw1 <- HoltWinters(complaints, beta = F, gamma = F) 
Comp.hw1
plot(Comp.hw1)
Comp.hw1$SSE
#alpha = 0.2
Comp.hw2 <- HoltWinters(complaints, alpha = 0.2, beta=F, gamma=F)
plot(Comp.hw2)
Comp.hw2$SSE
```

This example uses the Holt-Winters method for the prediction of the time series. First we input the dataset, use 'attach' to read a list of variables 'complains'.

First of all let's see the visualization of the time series:

![image-20220927034300921](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20220927034300921.png)

We can see obviously here is a seasonal effect. Then we want to use Holt-Winters method to predict the trend by the code:

```R
Comp.hw1 <- HoltWinters(complaints, beta = F, gamma = F) 
```

With the result visualized:

![image-20220927131919057](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20220927131919057.png)

With the coefficients and $SSE$ :

```R
Smoothing parameters:
 alpha: 0.1429622
 beta : FALSE
 gamma: FALSE

Coefficients:
      [,1]
a 17.70343
```

 We can see if we don't input the coefficients, it will give us the best fitted one with the least sum of errors.

Compare with coefficient $\alpha=2$ defined by us, we can see:

![image-20220927135821519](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20220927135821519.png)

With the $SSE=2526.9 > 2502.028$.

 So it's a convenient way for us to use function give us automatically coefficients.

## Sales of Australian wine

```R
#sales of australian wine
www <- "D:\\教学资料 \\研究生\\时间序列\\data\\chapter3 wine.dat.txt"
wine.dat <- read.table(www, header = T) ; 
attach (wine.dat)
sweetw.ts <- ts(sweetw, start = 1980, freq = 12)
plot(sweetw.ts, xlab= "Time (months)", ylab = "sales (1000 litres)")
sweetw.decom<-decompose(sweetw.ts,type="mult")
plot(sweetw.decom)
sweetw.hw <- HoltWinters (sweetw.ts, seasonal = "mult")
sweetw.hw ; sweetw.hw$coef ; sweetw.hw$SSE
sqrt(sweetw.hw$SSE/length(sweetw))
sd(sweetw)
plot (sweetw.hw$fitted)
plot (sweetw.hw)
```

This example helps us to get a further understanding of the function Holt-winters.

Well let's see how the Holt-Winters operate by the figure:

![image-20220928125442590](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20220928125442590.png)

We can see the trend term turns to stationary. With the Holt-Winters fitted figure:

![image-20220928130946570](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20220928130946570.png)

 It seems by using Holt-Winters filtering we get a good result. Let's check scientifically with $MSE$, we get MSE = 50.54219, quite small and proper.

## Four year ahead forecasts for the air passenger data

```R
#four year ahead forecasts for the air passenger data
data(AirPassengers)
AP <- AirPassengers
AP.hw <- HoltWinters(AP, seasonal = "mult")
plot(AP.hw)
AP.predict <- predict(AP.hw, n.ahead = 4 * 12)
ts.plot(AP, AP.predict, lty = 1:2)
```

This case tells us how to do a further prediction of Holt-Winters methods. Focus on the code :

```R
AP.predict <- predict(AP.hw, n.ahead = 4 * 12)
```

![image-20220928153743636](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20220928153743636.png)

We use $predict$ function here. Input the dataset first, then use  $n.ahead$  command, $4*12$ here means, 4 years, 12 months per year.

## 5. c),d)

![image-20220928141146034](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20220928141146034.png)

![img](file:///C:\Users\10306\Documents\Tencent Files\1030682463\Image\C2C\4CFE51299C229DE904A7E2EBEBEF21C4.png)

![img](file:///C:\Users\10306\Documents\Tencent Files\1030682463\Image\C2C\1AC8BF83300EACD63362630608755A63.png)

## 7. b),c),d) 

![image-20220928141336150](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20220928141336150.png)

```R
www <- 'D://教学资料//研究生//时间序列//data//chapter1 global.txt'
global <- scan(www)
global.ts <- ts(global, st = c(1856, 1), end = c(2005, 12),fr = 12)
global.decom <- decompose(global.ts)
# Plot the decomposed figure
plot(global.decom,)
Trend <- global.decom$trend
Seasonal <- global.decom$seasonal
ts.plot(cbind(Trend, Trend + Seasonal), lty = 1:2)

# Correlogram
global.random <- global.decom$random
acf_random <- acf(global.random,na.action = na.pass)$acf

# Holt-Winters model
global.hw0 <- HoltWinters(global.ts, seasonal = "mult")
plot(global.hw0)
global.hw <- HoltWinters(global.ts, seasonal = "add")
plot(global.hw)
global.hw0$SSE
global.hw$SSE  #Judge by SSE
global.hw$coefficients
```



### (b) Decomposed

First we print out the decomposition of additive time series.

![image-20221011160420440](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20221011160420440.png)

We can see it has an obvious seasonal trend. Then we plot the trend with superimposed seasonal effect below:

![image-20221011170917623](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20221011170917623.png)

### （c) Correlogram

![image-20221011190312235](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20221011190312235.png)

We can find the Periodicity in the figure. 

### (d) Holt-Winters model

There are 2 choice for us ： Multiplicative and additive. We try to make a comparison:

* multiplicative

![image-20221012160916086](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20221012160916086.png)

* additive 

![image-20221012161021957](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20221012161021957.png)

Obviously we can see additive case is more proper. We can also use MSE to help us make a decision:

![image-20221012161127468](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20221012161127468.png)

The error of additive is much less than multiplicative one. So we choose additive.

And finally we print out the coefficients:

![image-20221012161917110](C:\Users\10306\AppData\Roaming\Typora\typora-user-images\image-20221012161917110.png)

